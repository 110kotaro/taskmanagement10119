# タスク管理アプリ テストケース

## テストケースの記述形式
- **TC-XXX**: テストケースID
- **優先度**: High / Medium / Low
- **前提条件**: テスト実行前の状態
- **手順**: テスト実行手順
- **期待結果**: 期待される動作・結果
- **備考**: 補足情報

---

## 1. 認証・ユーザー管理

### 1.1 ユーザー登録

**TC-AUTH-001**: 新規ユーザー登録（正常系）
- **優先度**: High
- **前提条件**: 未ログイン状態
- **手順**:
  1. ログイン画面で「新規登録」をクリック
  2. メールアドレス、パスワード、表示名を入力
  3. 「登録」ボタンをクリック
- **期待結果**: 
  - ユーザーが作成される
  - Firestoreにユーザー情報が保存される
  - ホーム画面に遷移する
  - デフォルト設定（テーマ: light、通知設定: デフォルト値）が適用される

**TC-AUTH-002**: ユーザー登録（メールアドレス重複）
- **優先度**: High
- **前提条件**: 既存ユーザーが存在する
- **手順**:
  1. 既存ユーザーのメールアドレスで登録を試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - 登録が失敗する

**TC-AUTH-003**: ユーザー登録（パスワード要件不適合）
- **優先度**: Medium
- **前提条件**: 未ログイン状態
- **手順**:
  1. 6文字未満のパスワードで登録を試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - 登録が失敗する

**TC-AUTH-004**: ユーザー登録（無効なメールアドレス形式）
- **優先度**: Medium
- **前提条件**: 未ログイン状態
- **手順**:
  1. 無効なメールアドレス形式で登録を試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - 登録が失敗する

### 1.2 ログイン

**TC-AUTH-005**: ログイン（正常系）
- **優先度**: High
- **前提条件**: 登録済みユーザーが存在する
- **手順**:
  1. 正しいメールアドレスとパスワードを入力
  2. 「ログイン」ボタンをクリック
- **期待結果**: 
  - ログインが成功する
  - ホーム画面に遷移する
  - 認証状態が保持される

**TC-AUTH-006**: ログイン（パスワード誤り）
- **優先度**: High
- **前提条件**: 登録済みユーザーが存在する
- **手順**:
  1. 正しいメールアドレスと誤ったパスワードを入力
  2. 「ログイン」ボタンをクリック
- **期待結果**: 
  - エラーメッセージが表示される
  - ログインが失敗する

**TC-AUTH-007**: ログイン（存在しないユーザー）
- **優先度**: Medium
- **前提条件**: 未登録のメールアドレス
- **手順**:
  1. 存在しないメールアドレスでログインを試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - ログインが失敗する

**TC-AUTH-008**: ログアウト
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. サイドバーまたは設定画面から「ログアウト」をクリック
- **期待結果**: 
  - ログアウトが成功する
  - ログイン画面に遷移する
  - 認証状態がクリアされる

**TC-AUTH-009**: 認証状態の永続化
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. ブラウザを閉じる
  2. 再度アプリを開く
- **期待結果**: 
  - 自動的にログイン状態が復元される
  - ホーム画面が表示される

---

## 2. タスク管理

### 2.1 タスク作成

**TC-TASK-001**: 個人タスクの作成（最小限の情報）
- **優先度**: High
- **前提条件**: ログイン済み、個人モード
- **手順**:
  1. 「タスク作成」ボタンをクリック
  2. タイトル、開始日、終了日を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - タスクが作成される
  - 担当者が自動的に作成者に設定される
  - ホーム画面またはタスク一覧に表示される
  - 通知が作成者以外に送信されない

**TC-TASK-002**: 個人タスクの作成（全項目入力）
- **優先度**: High
- **前提条件**: ログイン済み、個人モード
- **手順**:
  1. タスク作成画面で全項目を入力
  2. 説明、メモ、優先度、タスクタイプ、リマインダー、サブタスクを設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 全項目が正しく保存される
  - サブタスクが正しく保存される
  - リマインダーが正しく設定される

**TC-TASK-003**: チームタスクの作成（担当者あり）
- **優先度**: High
- **前提条件**: ログイン済み、チームモード、チームメンバー
- **手順**:
  1. チームモードでタスク作成画面を開く
  2. タイトル、開始日、終了日、担当者を選択
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - タスクが作成される
  - `teamId`が設定される
  - 担当者に通知が送信される（作成者と異なる場合）
  - プロジェクトに紐づいている場合、プロジェクトメンバーに通知が送信される（作成者と担当者を除く）

**TC-TASK-003-2**: チームタスクの作成（担当者未割当）
- **優先度**: High
- **前提条件**: ログイン済み、チームモード、チームメンバー
- **手順**:
  1. チームモードでタスク作成画面を開く
  2. タイトル、開始日、終了日を入力（担当者は選択しない）
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - タスクが作成される
  - `teamId`が設定される
  - 作成者に通知が送信される（担当者未割当の場合）
  - プロジェクトに紐づいている場合、プロジェクトメンバーに通知が送信される（作成者を除く）

**TC-TASK-004**: プロジェクトタスクの作成
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクトが存在する
- **手順**:
  1. プロジェクト詳細画面から「タスク作成」をクリック
  2. タスク情報を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - タスクが作成される
  - `projectId`が設定される
  - 担当者に通知が送信される（担当者未割当の場合は作成者に通知、作成者と異なる場合）
  - プロジェクトメンバーに通知が送信される（作成者と担当者を除く）
  - プロジェクトの完了率が更新される

**TC-TASK-005**: タスク作成（必須項目未入力）
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. タイトルまたは終了日を入力せずに「作成」ボタンをクリック
- **期待結果**: 
  - エラーメッセージが表示される
  - タスクが作成されない

**TC-TASK-006**: タスク作成（終了日が開始日より前）
- **優先度**: Medium
- **前提条件**: ログイン済み
- **手順**:
  1. 開始日より前の終了日を設定
  2. 「作成」ボタンをクリック
- **期待結果**: 
  - エラーメッセージが表示される、または
  - バリデーションエラーが表示される

**TC-TASK-007**: 繰り返しタスクの作成（毎日）
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. タスク作成画面で繰り返しを「毎日」に設定
  2. 繰り返し終了日を設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 親タスクが作成される
  - 最大3か月分の子タスクが自動生成される
  - `isRecurrenceParent: true`が設定される
  - 子タスクに`recurrenceInstance`が設定される

**TC-TASK-008**: 繰り返しタスクの作成（毎週）
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. 繰り返しを「毎週」に設定
  2. 繰り返し終了日を設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 最大3か月分の子タスクが自動生成される

**TC-TASK-009**: 繰り返しタスクの作成（隔週）
- **優先度**: Medium
- **前提条件**: ログイン済み
- **手順**:
  1. 繰り返しを「隔週」に設定
  2. 繰り返し終了日を設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 最大6か月分の子タスクが自動生成される

**TC-TASK-010**: 繰り返しタスクの作成（毎月）
- **優先度**: Medium
- **前提条件**: ログイン済み
- **手順**:
  1. 繰り返しを「毎月」に設定
  2. 繰り返し終了日を設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 最大12か月分の子タスクが自動生成される

**TC-TASK-011**: 繰り返しタスクの作成（毎年）
- **優先度**: Low
- **前提条件**: ログイン済み
- **手順**:
  1. 繰り返しを「毎年」に設定
  2. 繰り返し終了日を設定
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - 最大36か月分の子タスクが自動生成される

### 2.2 タスク編集

**TC-TASK-012**: タスク編集（作成者）
- **優先度**: High
- **前提条件**: ログイン済み、自分が作成したタスクが存在する
- **手順**:
  1. タスク詳細画面で「編集」ボタンをクリック
  2. タイトル、説明、ステータスなどを変更
  3. 「保存」ボタンをクリック
- **期待結果**: 
  - 変更が保存される
  - 「○○が編集しました」という自動コメントが追加される
  - 担当者に通知が送信される（担当者未割当のチームタスクの場合は作成者に通知、更新者と異なる場合）
  - プロジェクトメンバーに通知が送信される（プロジェクトに紐づいている場合、更新者と担当者を除く）

**TC-TASK-013**: タスク編集（担当者 - チームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、自分が担当者のチームタスクが存在する
- **手順**:
  1. タスク詳細画面で「編集」ボタンをクリック
  2. 情報を変更して保存
- **期待結果**: 
  - 編集が成功する
  - 自動コメントが追加される

**TC-TASK-014**: タスク編集（権限なし）
- **優先度**: High
- **前提条件**: ログイン済み、他人が作成した個人タスクが存在する
- **手順**:
  1. タスク詳細画面を開く
- **期待結果**: 
  - 「編集」ボタンが表示されない、または
  - 編集ボタンをクリックしても編集できない

**TC-TASK-015**: タスク編集（タスクタイプ変更）
- **優先度**: Medium
- **前提条件**: ログイン済み、編集可能なタスクが存在する
- **手順**:
  1. タスク編集画面でタスクタイプを変更
  2. 保存
- **期待結果**: 
  - タスクタイプが正しく更新される

**TC-TASK-016**: タスク編集（繰り返し設定の変更）
- **優先度**: High
- **前提条件**: ログイン済み、繰り返しタスクの親タスクが存在する
- **手順**:
  1. 親タスクの繰り返し設定を変更
  2. 保存
- **期待結果**: 
  - 既存の子タスクが削除される
  - 新しい設定で子タスクが再生成される

**TC-TASK-017**: タスク編集（繰り返し設定の削除）
- **優先度**: Medium
- **前提条件**: ログイン済み、繰り返しタスクの親タスクが存在する
- **手順**:
  1. 繰り返し設定を「なし」に変更
  2. 保存
- **期待結果**: 
  - 既存の子タスクが削除される
  - 親タスクのみが残る

**TC-TASK-018**: タスク編集（サブタスクの追加・削除）
- **優先度**: Medium
- **前提条件**: ログイン済み、編集可能なタスクが存在する、進捗率表示が有効
- **手順**:
  1. サブタスクを追加
  2. サブタスクを削除
  3. 保存
- **期待結果**: 
  - サブタスクが正しく追加・削除される
  - 進捗率が自動計算される（手動修正でない場合）

**TC-TASK-019**: タスク編集（進捗率の手動修正）
- **優先度**: Medium
- **前提条件**: ログイン済み、編集可能なタスクが存在する
- **手順**:
  1. 進捗率を手動で変更
  2. 保存
- **期待結果**: 
  - 進捗率が手動で設定した値になる
  - `progressManual: true`が設定される
  - 自動計算が停止する

### 2.3 タスク削除・復元

**TC-TASK-020**: タスク削除（作成者）
- **優先度**: High
- **前提条件**: ログイン済み、自分が作成したタスクが存在する
- **手順**:
  1. タスク詳細画面で「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - タスクが論理削除される（`isDeleted: true`）
  - 削除前のステータスが保存される
  - 削除日時が記録される
  - 担当者に通知が送信される（担当者未割当のチームタスクの場合は作成者に通知、削除者と異なる場合）
  - プロジェクトメンバーに通知が送信される（プロジェクトに紐づいている場合、削除者と担当者を除く）
  - ゴミ箱に表示される

**TC-TASK-021**: タスク削除（チーム管理者）
- **優先度**: High
- **前提条件**: ログイン済み、チーム管理者、チームタスクが存在する
- **手順**:
  1. チームタスクの詳細画面で「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - タスクが削除される
  - 担当者に通知が送信される（担当者未割当の場合は作成者に通知、削除者と異なる場合）
  - プロジェクトメンバーに通知が送信される（プロジェクトに紐づいている場合、削除者と担当者を除く）

**TC-TASK-022**: タスク削除（権限なし）
- **優先度**: High
- **前提条件**: ログイン済み、他人が作成した個人タスクが存在する
- **手順**:
  1. タスク詳細画面を開く
- **期待結果**: 
  - 「削除」ボタンが表示されない、または
  - 削除ボタンをクリックしても削除できない

**TC-TASK-023**: タスク復元
- **優先度**: High
- **前提条件**: ログイン済み、削除されたタスクがゴミ箱に存在する
- **手順**:
  1. ゴミ箱画面でタスクを選択
  2. 「復元」ボタンをクリック
- **期待結果**: 
  - タスクが復元される（`isDeleted: false`）
  - 削除前のステータスが復元される
  - タスク一覧に表示される
  - 担当者に通知が送信される（担当者未割当のチームタスクの場合は作成者に通知、復元者と異なる場合）
  - プロジェクトメンバーに通知が送信される（プロジェクトに紐づいている場合、復元者と担当者を除く）

**TC-TASK-024**: タスク完全削除（個人タスク作成者）
- **優先度**: Medium
- **前提条件**: ログイン済み、自分が作成した削除済みタスクが存在する
- **手順**:
  1. ゴミ箱画面でタスクを選択
  2. 「完全削除」ボタンをクリック
  3. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - タスクが完全に削除される
  - Firestoreから削除される

**TC-TASK-025**: タスク完全削除（チーム管理者）
- **優先度**: Medium
- **前提条件**: ログイン済み、チーム管理者、削除済みチームタスクが存在する
- **手順**:
  1. ゴミ箱画面でチームタスクを選択
  2. 「完全削除」ボタンをクリック
- **期待結果**: 
  - タスクが完全に削除される

**TC-TASK-026**: タスク完全削除（権限なし）
- **優先度**: Medium
- **前提条件**: ログイン済み、他人が作成した削除済みタスクが存在する
- **手順**:
  1. ゴミ箱画面を開く
- **期待結果**: 
  - 「完全削除」ボタンが表示されない、または
  - 完全削除ができない

### 2.4 タスク複製

**TC-TASK-027**: タスク複製
- **優先度**: Medium
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク詳細画面で「複製」ボタンをクリック
- **期待結果**: 
  - 新しいタスクが作成される
  - タイトルに「(複製)」が追加される
  - ステータスが「未着手」にリセットされる
  - サブタスクが未完了にリセットされる
  - リマインダーが未送信にリセットされる
  - コメント、作業セッション、ファイルは複製されない

### 2.5 タスク表示

**TC-TASK-028**: ホーム画面の表示（今日のタスク）
- **優先度**: High
- **前提条件**: ログイン済み、今日の開始日または終了日のタスクが存在する
- **手順**:
  1. ホーム画面を開く
- **期待結果**: 
  - 「今日のタスク」セクションに該当タスクが表示される
  - カテゴリ別（開始日、終了日、その他）に分類される
  - カテゴリの展開/折りたたみが可能

**TC-TASK-029**: ホーム画面の表示（今週のタスク）
- **優先度**: High
- **前提条件**: ログイン済み、今週の開始日または終了日のタスクが存在する
- **手順**:
  1. ホーム画面を開く
- **期待結果**: 
  - 「今週のタスク」セクションに該当タスクが表示される
  - 期間変更機能が動作する

**TC-TASK-030**: タスク一覧（リスト表示）
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク一覧画面を開く
  2. リスト表示モードを選択
- **期待結果**: 
  - タスクがテーブル形式で表示される
  - 期限切れタスクが背景色で区別される（開始日過ぎ: 黄色、終了日過ぎ: 赤色）

**TC-TASK-031**: タスク一覧（カード表示）
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク一覧画面を開く
  2. カード表示モードを選択
- **期待結果**: 
  - タスクがカンバン形式で表示される
  - ステータス別にカードが配置される

**TC-TASK-032**: タスク一覧（フィルター - ステータス）
- **優先度**: High
- **前提条件**: ログイン済み、複数のステータスのタスクが存在する
- **手順**:
  1. タスク一覧画面でステータスフィルターを選択（複数選択可能）
- **期待結果**: 
  - 選択したステータスのタスクのみが表示される
  - 何も選択していない場合はタスクが表示されない

**TC-TASK-033**: タスク一覧（フィルター - 期限切れ）
- **優先度**: High
- **前提条件**: ログイン済み、期限切れタスクが存在する
- **手順**:
  1. タスク一覧画面で「期限切れ」チェックボックスをチェック
- **期待結果**: 
  - 期限切れタスクのみが表示される

**TC-TASK-034**: タスク一覧（フィルター - 優先度）
- **優先度**: Medium
- **前提条件**: ログイン済み、複数の優先度のタスクが存在する
- **手順**:
  1. タスク一覧画面で優先度フィルターを選択（複数選択可能）
- **期待結果**: 
  - 選択した優先度のタスクのみが表示される

**TC-TASK-035**: タスク一覧（フィルター - タスクタイプ）
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のタスクタイプのタスクが存在する
- **手順**:
  1. タスク一覧画面でタスクタイプフィルターを選択（複数選択可能）
- **期待結果**: 
  - 選択したタスクタイプのタスクのみが表示される

**TC-TASK-036**: タスク一覧（ソート - 終了日）
- **優先度**: High
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. タスク一覧画面でソートを「終了日」に設定
  2. 昇順/降順を切り替え
- **期待結果**: 
  - タスクが終了日順にソートされる
  - 昇順/降順が正しく切り替わる

**TC-TASK-037**: タスク一覧（ソート - 作成日）
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. タスク一覧画面でソートを「作成日」に設定
- **期待結果**: 
  - タスクが作成日順にソートされる

**TC-TASK-038**: タスク一覧（ソート - 優先度）
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. タスク一覧画面でソートを「優先度」に設定
- **期待結果**: 
  - タスクが優先度順にソートされる

**TC-TASK-039**: タスク一覧（一括削除）
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. タスク一覧画面で複数のタスクを選択
  2. 「一括削除」ボタンをクリック
  3. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - 選択したタスクがすべて削除される
  - エラーが発生しても成功したタスクは削除される

**TC-TASK-040**: タスク詳細画面の表示
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク一覧またはホーム画面からタスクをクリック
- **期待結果**: 
  - タスクの全情報が表示される
  - 編集可能な場合は「編集」ボタンが表示される
  - コメント、ファイル、作業セッションが表示される

### 2.6 繰り返しタスクの自動生成

**TC-TASK-041**: 繰り返しタスクのローリング生成
- **優先度**: High
- **前提条件**: ログイン済み、繰り返しタスクの親タスクが存在する
- **手順**:
  1. 最初の子タスクの終了日が過ぎるまで待つ
  2. アプリを起動または1分経過を待つ
- **期待結果**: 
  - 次の子タスクが自動生成される
  - `checkAndGenerateNextRecurrenceTask`が実行される

**TC-TASK-042**: 繰り返しタスクの生成（親タスクのみの場合）
- **優先度**: Medium
- **前提条件**: ログイン済み、繰り返しタスクの親タスクが存在するが、子タスクがまだ生成されていない
- **手順**:
  1. 親タスクの終了日が過ぎるまで待つ
  2. アプリを起動
- **期待結果**: 
  - 最初の子タスクが生成される
  - `lastInstanceNumber`が0の場合でもエラーが発生しない

### 2.7 タスク権限

**TC-TASK-043**: タスク閲覧権限（個人タスク）
- **優先度**: High
- **前提条件**: ログイン済み、他人が作成した個人タスクが存在する
- **手順**:
  1. タスク詳細画面を開こうとする
- **期待結果**: 
  - 閲覧できない、または
  - タスク一覧に表示されない

**TC-TASK-044**: タスク閲覧権限（チームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、チームメンバー、チームタスクが存在する
- **手順**:
  1. タスク詳細画面を開く
- **期待結果**: 
  - タスクが閲覧できる
  - チームメンバー全員が閲覧可能

**TC-TASK-045**: タスク閲覧権限（プロジェクトタスク）
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクトメンバー、プロジェクトタスクが存在する
- **手順**:
  1. タスク詳細画面を開く
- **期待結果**: 
  - タスクが閲覧できる
  - プロジェクトメンバー全員が閲覧可能

**TC-TASK-046**: タスク編集権限（担当者）
- **優先度**: High
- **前提条件**: ログイン済み、自分が担当者のチームタスクが存在する
- **手順**:
  1. タスク詳細画面で「編集」ボタンをクリック
- **期待結果**: 
  - 編集が可能

**TC-TASK-047**: タスク編集権限（チーム管理者）
- **優先度**: High
- **前提条件**: ログイン済み、チーム管理者、チームタスクが存在する
- **手順**:
  1. タスク詳細画面で「編集」ボタンをクリック
- **期待結果**: 
  - 編集が可能

**TC-TASK-048**: タスク削除権限（プロジェクトオーナー）
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクトオーナー、プロジェクトタスクが存在する
- **手順**:
  1. タスク詳細画面で「削除」ボタンをクリック
- **期待結果**: 
  - 削除が可能

---

## 3. プロジェクト管理

### 3.1 プロジェクト作成

**TC-PROJ-001**: 個人プロジェクトの作成
- **優先度**: High
- **前提条件**: ログイン済み、個人モード
- **手順**:
  1. 「プロジェクト作成」ボタンをクリック
  2. プロジェクト名、開始日、終了日を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - プロジェクトが作成される
  - 作成者が自動的にオーナーとして追加される
  - プロジェクト一覧に表示される

**TC-PROJ-002**: チームプロジェクトの作成
- **優先度**: High
- **前提条件**: ログイン済み、チームモード、チームメンバー
- **手順**:
  1. チームモードでプロジェクト作成画面を開く
  2. プロジェクト情報を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - プロジェクトが作成される
  - `teamId`が設定される
  - チームメンバー全員が閲覧可能

**TC-PROJ-003**: プロジェクト作成（必須項目未入力）
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. プロジェクト名または終了日を入力せずに「作成」ボタンをクリック
- **期待結果**: 
  - エラーメッセージが表示される
  - プロジェクトが作成されない

### 3.2 プロジェクト編集

**TC-PROJ-004**: プロジェクト編集（オーナー）
- **優先度**: High
- **前提条件**: ログイン済み、自分がオーナーのプロジェクトが存在する
- **手順**:
  1. プロジェクト詳細画面で「編集」ボタンをクリック
  2. プロジェクト情報を変更
  3. 「保存」ボタンをクリック
- **期待結果**: 
  - 変更が保存される
  - 自動コメントが追加される
  - プロジェクトメンバーに通知が送信される

**TC-PROJ-005**: プロジェクト編集（プロジェクト担当者）
- **優先度**: High
- **前提条件**: ログイン済み、自分が担当者のプロジェクトが存在する
- **手順**:
  1. プロジェクト詳細画面で「編集」ボタンをクリック
  2. 情報を変更して保存
- **期待結果**: 
  - 編集が成功する

**TC-PROJ-006**: プロジェクト編集（権限なし）
- **優先度**: High
- **前提条件**: ログイン済み、他人が作成したプロジェクトのメンバー（オーナー・担当者以外）
- **手順**:
  1. プロジェクト詳細画面を開く
- **期待結果**: 
  - 「編集」ボタンが表示されない、または
  - 編集ができない

### 3.3 プロジェクトメンバー管理

**TC-PROJ-007**: プロジェクトメンバーの追加（チームプロジェクト）
- **優先度**: High
- **前提条件**: ログイン済み、チームプロジェクト、メンバー管理権限あり
- **手順**:
  1. プロジェクト詳細画面で「メンバー追加」ボタンをクリック
  2. チームメンバーを選択
  3. 「追加」ボタンをクリック
- **期待結果**: 
  - メンバーが追加される
  - プロジェクトメンバーに通知が送信される

**TC-PROJ-008**: プロジェクトメンバーの削除
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクト、メンバー管理権限あり
- **手順**:
  1. プロジェクト詳細画面でメンバーの「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - メンバーが削除される
  - そのメンバーが担当しているタスクが未割り当てになる
  - 削除されたメンバーと他のメンバーに通知が送信される

**TC-PROJ-009**: プロジェクトメンバー削除（オーナーは削除不可）
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクト、メンバー管理権限あり
- **手順**:
  1. プロジェクト詳細画面でオーナーのメンバーカードを確認
- **期待結果**: 
  - オーナーの「削除」ボタンが表示されない

### 3.4 プロジェクト完了率

**TC-PROJ-010**: プロジェクト完了率の自動計算
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクト、タスクが存在する
- **手順**:
  1. プロジェクト内のタスクを完了にする
- **期待結果**: 
  - プロジェクトの完了率が自動更新される
  - `completedTasks`と`totalTasks`が正しく更新される

**TC-PROJ-011**: プロジェクト完了率100%時の通知
- **優先度**: Medium
- **前提条件**: ログイン済み、プロジェクト、タスクが存在する
- **手順**:
  1. プロジェクト内の全タスクを完了にする
- **期待結果**: 
  - 完了率が100%になる
  - プロジェクトオーナーと担当者に通知が送信される

### 3.5 プロジェクト削除・復元

**TC-PROJ-012**: プロジェクト削除
- **優先度**: High
- **前提条件**: ログイン済み、自分がオーナーのプロジェクトが存在する
- **手順**:
  1. プロジェクト詳細画面で「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - プロジェクトが論理削除される
  - 配下のタスクIDが保存される
  - プロジェクトメンバーに通知が送信される

**TC-PROJ-013**: プロジェクト復元
- **優先度**: High
- **前提条件**: ログイン済み、削除されたプロジェクトがゴミ箱に存在する
- **手順**:
  1. ゴミ箱画面でプロジェクトを選択
  2. 「復元」ボタンをクリック
- **期待結果**: 
  - プロジェクトが復元される
  - 配下のタスクも復元される（タスクIDが保存されていた場合）

---

## 4. チーム管理

### 4.1 チーム作成

**TC-TEAM-001**: チーム作成
- **優先度**: High
- **前提条件**: ログイン済み
- **手順**:
  1. 「チーム作成」ボタンをクリック
  2. チーム名、説明を入力
  3. 「作成」ボタンをクリック
- **期待結果**: 
  - チームが作成される
  - 作成者が自動的にオーナーとして追加される
  - チーム一覧に表示される

### 4.2 チームメンバー招待

**TC-TEAM-002**: メール招待
- **優先度**: High
- **前提条件**: ログイン済み、チーム、招待権限あり
- **手順**:
  1. チーム詳細画面で「メンバー招待」ボタンをクリック
  2. メールアドレスを入力
  3. 「招待」ボタンをクリック
- **期待結果**: 
  - 招待が作成される（`invitationType: 'email'`）
  - 招待されたユーザーに通知が送信される
  - 「招待中」一覧に表示される

**TC-TEAM-003**: リンク招待の生成
- **優先度**: High
- **前提条件**: ログイン済み、チーム、招待権限あり
- **手順**:
  1. チーム詳細画面で「招待リンク生成」ボタンをクリック
- **期待結果**: 
  - 招待リンクが生成される
  - リンクがコピーできる

**TC-TEAM-004**: リンク招待での参加
- **優先度**: High
- **前提条件**: 招待リンクが存在する
- **手順**:
  1. 招待リンクにアクセス
  2. ログインまたは新規登録
- **期待結果**: 
  - チームに参加できる
  - チームメンバーに通知が送信される（参加者を除く）

**TC-TEAM-005**: 招待の承認
- **優先度**: High
- **前提条件**: ログイン済み、メール招待が存在する
- **手順**:
  1. 通知画面で招待通知をクリック
  2. 「承認」ボタンをクリック
- **期待結果**: 
  - チームに参加できる
  - 招待者とチームメンバーに通知が送信される（承認者を除く）

**TC-TEAM-006**: 招待の拒否
- **優先度**: Medium
- **前提条件**: ログイン済み、メール招待が存在する
- **手順**:
  1. 通知画面で招待通知をクリック
  2. 「拒否」ボタンをクリック
- **期待結果**: 
  - 招待が拒否される
  - 招待者にのみ通知が送信される
  - 「承認済み」「拒否済み」のメッセージが表示される

### 4.3 チームメンバー管理

**TC-TEAM-007**: チームメンバーの削除
- **優先度**: High
- **前提条件**: ログイン済み、チーム、メンバー管理権限あり
- **手順**:
  1. チーム詳細画面でメンバーの「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - メンバーが削除される
  - そのメンバーを関連プロジェクトからも削除する
  - そのメンバーが担当しているタスク・プロジェクトを未割り当てにする
  - 削除されたメンバーと他のメンバーに通知が送信される

**TC-TEAM-008**: チームメンバーの権限変更
- **優先度**: High
- **前提条件**: ログイン済み、チーム、メンバー管理権限あり
- **手順**:
  1. チーム詳細画面でメンバーの権限を変更
  2. 「保存」ボタンをクリック
- **期待結果**: 
  - 権限が変更される
  - 変更されたメンバーと他のメンバーに通知が送信される（変更操作者を除く）

**TC-TEAM-009**: チーム退会
- **優先度**: High
- **前提条件**: ログイン済み、チームメンバー（オーナー以外）
- **手順**:
  1. チーム詳細画面で「退会」ボタンをクリック
  2. 確認ダイアログで「退会」を選択
- **期待結果**: 
  - チームから退会する
  - そのメンバーを関連プロジェクトからも削除する
  - そのメンバーが担当しているタスク・プロジェクトを未割り当てにする
  - チームメンバーに通知が送信される（退会者を除く）

**TC-TEAM-010**: チーム削除（オーナーのみ）
- **優先度**: Medium
- **前提条件**: ログイン済み、チームオーナー
- **手順**:
  1. チーム詳細画面で「削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - チームが論理削除される
  - 管理者は削除できない

---

## 5. 日付チェック機能

### 5.1 タスクの日付チェック

**TC-DATECHECK-001**: 開始日チェック（未着手タスク - 担当者あり）
- **優先度**: High
- **前提条件**: ログイン済み、開始日が過ぎた未着手タスクが存在する（担当者が自分）
- **手順**:
  1. アプリを起動する
  2. 日付チェックが実行されるまで待つ（1分以内）
- **期待結果**: 
  - 確認モーダルが表示される
  - 通知が作成される（通知設定で有効な場合）
  - `dateCheckedAt`が更新される

**TC-DATECHECK-001-2**: 開始日チェック（未着手タスク - 担当者未割当のチームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、開始日が過ぎた未着手チームタスクが存在する（担当者未割当、作成者が自分）
- **手順**:
  1. アプリを起動する
  2. 日付チェックが実行されるまで待つ（1分以内）
- **期待結果**: 
  - 確認モーダルが表示される
  - 作成者に通知が作成される（通知設定で有効な場合）
  - `dateCheckedAt`が更新される

**TC-DATECHECK-002**: 終了日チェック（未着手タスク - 担当者あり）
- **優先度**: High
- **前提条件**: ログイン済み、終了日が過ぎた未着手タスクが存在する（担当者が自分）
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される
  - 通知が作成される

**TC-DATECHECK-002-2**: 終了日チェック（未着手タスク - 担当者未割当のチームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、終了日が過ぎた未着手チームタスクが存在する（担当者未割当、作成者が自分）
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される
  - 作成者に通知が作成される

**TC-DATECHECK-003**: 終了日チェック（進行中タスク - 担当者あり）
- **優先度**: High
- **前提条件**: ログイン済み、終了日が過ぎた進行中タスクが存在する（担当者が自分）
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される

**TC-DATECHECK-003-2**: 終了日チェック（進行中タスク - 担当者未割当のチームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、終了日が過ぎた進行中チームタスクが存在する（担当者未割当、作成者が自分）
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される
  - 作成者に通知が作成される

**TC-DATECHECK-004**: 日付チェック（時間23:59:59のタスク）
- **優先度**: Medium
- **前提条件**: ログイン済み、終了日時が23:59:59のタスクが存在する
- **手順**:
  1. 終了日の翌日の00:00:00以降にアプリを起動する
- **期待結果**: 
  - 終了日の翌日と比較して期限切れと判定される
  - 確認モーダルが表示される

**TC-DATECHECK-005**: 日付チェック（1日1回のみ）
- **優先度**: High
- **前提条件**: ログイン済み、日付チェック済みのタスクが存在する
- **手順**:
  1. 同じ日に再度アプリを起動する
- **期待結果**: 
  - 同じタスクの確認モーダルが再度表示されない
  - `dateCheckedAt`が同じ日の場合はスキップされる

**TC-DATECHECK-006**: 日付チェック通知からのモーダル表示
- **優先度**: High
- **前提条件**: ログイン済み、日付チェック通知が存在する
- **手順**:
  1. 通知画面で日付チェック通知をクリック
- **期待結果**: 
  - 確認モーダルが表示される
  - `dateCheckedAt`を無視して現在の状態をチェックする

**TC-DATECHECK-007**: 日付チェック後のステータス変更で再チェック
- **優先度**: High
- **前提条件**: ログイン済み、日付チェック済みのタスクが存在する
- **手順**:
  1. タスクのステータスを「未着手」に戻す
  2. アプリを起動する
- **期待結果**: 
  - `dateCheckedAt`がリセットされる
  - 再度日付チェックが実行される

### 5.2 プロジェクトの日付チェック

**TC-DATECHECK-008**: プロジェクト開始日チェック
- **優先度**: High
- **前提条件**: ログイン済み、開始日が過ぎた準備中プロジェクトが存在する
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - プロジェクトのステータスが自動的に「進行中」に変更される

**TC-DATECHECK-009**: プロジェクト終了日チェック
- **優先度**: High
- **前提条件**: ログイン済み、終了日が過ぎた未完了プロジェクトが存在する
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される（管理者またはプロジェクト担当者のみ）
  - 通知が作成される

**TC-DATECHECK-010**: プロジェクト完了率100%チェック
- **優先度**: High
- **前提条件**: ログイン済み、完了率100%の未完了プロジェクトが存在する
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 確認モーダルが表示される（管理者またはプロジェクト担当者のみ）
  - 通知が作成される

**TC-DATECHECK-011**: 日付チェック対象タスクの判定
- **優先度**: High
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. アプリを起動する
- **期待結果**: 
  - 担当者が自分のタスクがチェック対象になる
  - チームタスクで担当者未割当で作成者が自分のタスクがチェック対象になる
  - 担当者が他人のタスクはチェック対象にならない
  - チームタスクで担当者未割当で作成者が他人のタスクはチェック対象にならない

---

## 6. リマインダー機能

### 6.1 リマインダー設定

**TC-REMINDER-001**: 開始前リマインダーの設定
- **優先度**: High
- **前提条件**: ログイン済み、タスク作成画面
- **手順**:
  1. 「開始前リマインダー」を有効にする
  2. リマインダー時間を選択（例: 1時間前）
  3. タスクを作成
- **期待結果**: 
  - リマインダーが正しく設定される
  - `reminders`配列にリマインダーが追加される

**TC-REMINDER-002**: 期限前リマインダーの設定
- **優先度**: High
- **前提条件**: ログイン済み、タスク作成画面
- **手順**:
  1. 「期限前リマインダー」を有効にする
  2. リマインダー時間を選択（例: 1日前）
  3. タスクを作成
- **期待結果**: 
  - リマインダーが正しく設定される

**TC-REMINDER-003**: カスタムリマインダーの設定
- **優先度**: Medium
- **前提条件**: ログイン済み、タスク作成画面
- **手順**:
  1. 「カスタムリマインダー」を有効にする
  2. 日時を設定
  3. タスクを作成
- **期待結果**: 
  - カスタムリマインダーが正しく設定される
  - `scheduledAt`が設定される

**TC-REMINDER-004**: 複数リマインダーの設定
- **優先度**: Medium
- **前提条件**: ログイン済み、タスク作成画面
- **手順**:
  1. 開始前リマインダーと期限前リマインダーの両方を設定
  2. タスクを作成
- **期待結果**: 
  - 複数のリマインダーが正しく設定される

### 6.2 リマインダー送信

**TC-REMINDER-005**: リマインダー送信（開始前 - 担当者あり）
- **優先度**: High
- **前提条件**: ログイン済み、開始前リマインダーが設定されたタスクが存在する（担当者が自分）
- **手順**:
  1. リマインダー時間が経過するまで待つ
  2. Cloud Functionsが実行される
- **期待結果**: 
  - 通知が作成される（通知設定で有効な場合）
  - WebPush通知が送信される（通知設定で有効な場合）
  - `sent: true`が設定される

**TC-REMINDER-005-2**: リマインダー送信（開始前 - 担当者未割当のチームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、開始前リマインダーが設定されたチームタスクが存在する（担当者未割当、作成者が自分）
- **手順**:
  1. リマインダー時間が経過するまで待つ
  2. Cloud Functionsが実行される
- **期待結果**: 
  - 作成者に通知が作成される（通知設定で有効な場合）
  - 作成者にWebPush通知が送信される（通知設定で有効な場合）
  - `sent: true`が設定される

**TC-REMINDER-006**: リマインダー送信（通知設定で無効）
- **優先度**: Medium
- **前提条件**: ログイン済み、リマインダーが設定されたタスクが存在する、通知設定でリマインダーが無効
- **手順**:
  1. リマインダー時間が経過するまで待つ
- **期待結果**: 
  - 通知が作成されない
  - WebPush通知が送信されない

**TC-REMINDER-007**: リマインダー対象タスクの判定
- **優先度**: High
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. Cloud Functionsが実行される
- **期待結果**: 
  - 担当者が自分のタスクのリマインダーが送信される
  - チームタスクで担当者未割当で作成者が自分のタスクのリマインダーが送信される
  - 担当者が他人のタスクのリマインダーは送信されない
  - チームタスクで担当者未割当で作成者が他人のタスクのリマインダーは送信されない

---

## 7. 通知システム

### 7.1 通知表示

**TC-NOTIF-001**: 通知一覧の表示
- **優先度**: High
- **前提条件**: ログイン済み、通知が存在する
- **手順**:
  1. 通知画面を開く
- **期待結果**: 
  - 通知が一覧表示される
  - 未読/既読が区別される

**TC-NOTIF-002**: 通知の既読化
- **優先度**: Medium
- **前提条件**: ログイン済み、未読通知が存在する
- **手順**:
  1. 通知をクリック
- **期待結果**: 
  - 通知が既読になる
  - `isRead: true`が設定される
  - `readAt`が記録される

**TC-NOTIF-003**: 通知の削除
- **優先度**: Medium
- **前提条件**: ログイン済み、通知が存在する
- **手順**:
  1. 通知画面で通知の「削除」ボタンをクリック
- **期待結果**: 
  - 通知が論理削除される
  - ゴミ箱に表示される

**TC-NOTIF-004**: 通知の一括削除
- **優先度**: Medium
- **前提条件**: ログイン済み、複数の通知が存在する
- **手順**:
  1. 通知画面で「一括削除」ボタンをクリック
- **期待結果**: 
  - フィルターされた通知がすべて削除される

**TC-NOTIF-005**: 通知の復元
- **優先度**: Medium
- **前提条件**: ログイン済み、削除された通知がゴミ箱に存在する
- **手順**:
  1. ゴミ箱画面で通知の「復元」ボタンをクリック
- **期待結果**: 
  - 通知が復元される

**TC-NOTIF-006**: 通知の完全削除
- **優先度**: Low
- **前提条件**: ログイン済み、削除された通知がゴミ箱に存在する
- **手順**:
  1. ゴミ箱画面で通知の「完全削除」ボタンをクリック
- **期待結果**: 
  - 通知が完全に削除される

**TC-NOTIF-007**: 日付チェック通知からのモーダル表示
- **優先度**: High
- **前提条件**: ログイン済み、日付チェック通知が存在する
- **手順**:
  1. 通知画面で日付チェック通知をクリック
- **期待結果**: 
  - 確認モーダルが表示される
  - プロジェクト日付チェック通知の場合もモーダルが表示される

### 7.2 通知設定

**TC-NOTIF-008**: 通知設定の変更
- **優先度**: High
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. 通知設定画面で各設定を変更
  2. 「保存」ボタンをクリック
- **期待結果**: 
  - 設定が保存される
  - 変更後の通知が設定に従って送信される

**TC-NOTIF-009**: WebPush通知の許可
- **優先度**: High
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. WebPush通知を有効にする
  2. ブラウザの通知許可を確認
- **期待結果**: 
  - FCMトークンが取得される
  - WebPush通知が送信される

---

## 8. コメント機能

### 8.1 タスクコメント

**TC-COMMENT-001**: タスクコメントの追加
- **優先度**: High
- **前提条件**: ログイン済み、閲覧可能なタスクが存在する
- **手順**:
  1. タスク詳細画面でコメントを入力
  2. 「コメント追加」ボタンをクリック
- **期待結果**: 
  - コメントが追加される
  - コメント一覧に表示される
  - 自動コメントは追加されない

**TC-COMMENT-002**: タスクコメントの@メンション（プロジェクトタスク）
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクトタスクが存在する
- **手順**:
  1. コメント入力欄で「@」を入力
  2. メンション候補からプロジェクトメンバーを選択
  3. コメントを送信
- **期待結果**: 
  - コメントに@メンションが含まれる
  - `mentionedUserIds`が設定される
  - メンションされたユーザーに通知が送信される（コメント者を除く）

**TC-COMMENT-003**: タスクコメントの@メンション（チームタスク）
- **優先度**: High
- **前提条件**: ログイン済み、チームタスクが存在する
- **手順**:
  1. コメント入力欄で「@」を入力
  2. メンション候補からチームメンバーを選択
- **期待結果**: 
  - チームメンバーのみがメンション候補に表示される

**TC-COMMENT-004**: タスクコメントの@メンション（個人タスク）
- **優先度**: Medium
- **前提条件**: ログイン済み、個人タスクが存在する
- **手順**:
  1. コメント入力欄で「@」を入力
- **期待結果**: 
  - メンション候補が表示されない

**TC-COMMENT-005**: タスクの自動コメント（ステータス変更）
- **優先度**: Medium
- **前提条件**: ログイン済み、編集可能なタスクが存在する
- **手順**:
  1. タスクのステータスを変更して保存
- **期待結果**: 
  - 「ステータスを○○に変更しました」という自動コメントが追加される

**TC-COMMENT-006**: タスクの自動コメント（終了日変更）
- **優先度**: Medium
- **前提条件**: ログイン済み、編集可能なタスクが存在する
- **手順**:
  1. タスクの終了日を変更して保存
- **期待結果**: 
  - 「終了日を変更しました」という自動コメントが追加される

### 8.2 プロジェクトコメント

**TC-COMMENT-007**: プロジェクトコメントの追加
- **優先度**: High
- **前提条件**: ログイン済み、閲覧可能なプロジェクトが存在する
- **手順**:
  1. プロジェクト詳細画面でコメントを入力
  2. 「コメント追加」ボタンをクリック
- **期待結果**: 
  - コメントが追加される
  - 自動コメントは追加されない

**TC-COMMENT-008**: プロジェクトコメントの@メンション
- **優先度**: High
- **前提条件**: ログイン済み、プロジェクトが存在する
- **手順**:
  1. コメント入力欄で「@」を入力
  2. メンション候補からプロジェクトメンバーを選択
- **期待結果**: 
  - プロジェクトメンバーのみがメンション候補に表示される
  - メンションされたユーザーに通知が送信される

### 8.3 コメント検索

**TC-COMMENT-009**: コメント検索（文字列）
- **優先度**: Medium
- **前提条件**: ログイン済み、コメントが存在する
- **手順**:
  1. コメント一覧画面で検索キーワードを入力
- **期待結果**: 
  - キーワードが含まれるコメントが表示される

**TC-COMMENT-010**: コメント検索（プロジェクト名）
- **優先度**: Medium
- **前提条件**: ログイン済み、プロジェクトタスクのコメントが存在する
- **手順**:
  1. コメント一覧画面でプロジェクト名を入力
- **期待結果**: 
  - そのプロジェクト下のタスクのコメントが表示される

---

## 9. 作業時間計測

### 9.1 通常タイマー

**TC-TIMER-001**: 通常タイマーの開始
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク詳細画面で「作業開始」ボタンをクリック
  2. 「通常タイマー」を選択
- **期待結果**: 
  - タイマーが開始される
  - ストップウォッチが表示される

**TC-TIMER-002**: 通常タイマーの一時停止・再開
- **優先度**: High
- **前提条件**: ログイン済み、タイマーが動作中
- **手順**:
  1. 「一時停止」ボタンをクリック
  2. 「再開」ボタンをクリック
- **期待結果**: 
  - タイマーが一時停止する
  - タイマーが再開する

**TC-TIMER-003**: 通常タイマーの終了
- **優先度**: High
- **前提条件**: ログイン済み、タイマーが動作中
- **手順**:
  1. 「終了」ボタンをクリック
  2. 確認ダイアログで「記録」を選択
- **期待結果**: 
  - 作業セッションが記録される
  - タスクの`workSessions`に追加される
  - `totalWorkTime`が更新される

### 9.2 ポモドーロタイマー

**TC-TIMER-004**: ポモドーロタイマーの開始
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. タスク詳細画面で「作業開始」ボタンをクリック
  2. 「ポモドーロ」を選択
- **期待結果**: 
  - 25分タイマーが開始される
  - ストップウォッチが表示される

**TC-TIMER-005**: ポモドーロ完了後の休憩開始
- **優先度**: High
- **前提条件**: ログイン済み、ポモドーロタイマーが25分経過
- **手順**:
  1. 25分経過後に「休憩開始」ボタンをクリック
- **期待結果**: 
  - 休憩時間（5分）の計測が開始される
  - 通知が表示される

**TC-TIMER-006**: ポモドーロの休憩スキップ
- **優先度**: Medium
- **前提条件**: ログイン済み、ポモドーロ完了後
- **手順**:
  1. 「休憩をスキップ」ボタンをクリック
- **期待結果**: 
  - 次のポモドーロが開始される
  - 休憩時間の計測は開始されない

**TC-TIMER-007**: ポモドーロの休憩完了通知
- **優先度**: Medium
- **前提条件**: ログイン済み、ポモドーロの休憩中
- **手順**:
  1. 5分経過するまで待つ
- **期待結果**: 
  - 休憩時間終了の通知が表示される
  - タイマーが停止する

**TC-TIMER-008**: ポモドーロの休憩5分ごとの再開通知
- **優先度**: Medium
- **前提条件**: ログイン済み、ポモドーロの休憩中、5分経過後
- **手順**:
  1. 5分経過後、さらに5分待つ
- **期待結果**: 
  - 再開を促す通知が表示される（5分ごと）

**TC-TIMER-009**: ポモドーロの作業セッション記録　
- **優先度**: High
- **前提条件**: ログイン済み、ポモドーロタイマーが動作中
- **手順**:
  1. 複数のポモドーロを完了
  2. 「終了」ボタンをクリック
  3. 確認ダイアログで「記録」を選択
- **期待結果**: 
  - 作業セッションが記録される
  - `completedPomodoros`が正しく記録される
  - 休憩時間が正しく記録される

---

## 10. ガントチャート

### 10.1 ガントチャート表示

**TC-GANTT-001**: ガントチャートの表示
- **優先度**: High
- **前提条件**: ログイン済み、タスクが存在する
- **手順**:
  1. ガントチャート画面を開く
- **期待結果**: 
  - タスクが時系列で表示される
  - 日付範囲が自動調整される

**TC-GANTT-002**: ガントチャートのツールチップ表示
- **優先度**: Medium
- **前提条件**: ログイン済み、タスクが存在する、ガントチャート画面
- **手順**:
  1. タスクバーにマウスをホバー
- **期待結果**: 
  - タスクの詳細情報がツールチップで表示される
  - チーム名が表示される（チームタスクの場合）

**TC-GANTT-003**: ガントチャートのフィルター
- **優先度**: High
- **前提条件**: ログイン済み、複数のステータス・優先度・タスクタイプのタスクが存在する
- **手順**:
  1. ガントチャート画面でフィルターを設定
- **期待結果**: 
  - フィルター条件に合致するタスクのみが表示される
  - ステータスフィルターに「完了済み」が含まれる

**TC-GANTT-004**: ガントチャートのソート
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のタスクが存在する
- **手順**:
  1. ガントチャート画面でソートを設定
- **期待結果**: 
  - タスクがソート順に表示される

### 10.2 ガントチャートでのドラッグ編集

**TC-GANTT-005**: ガントチャートでの期間変更（バー全体ドラッグ）
- **優先度**: High
- **前提条件**: ログイン済み、編集可能なタスクが存在する、ガントチャート画面
- **手順**:
  1. タスクバーをドラッグして移動
  2. マウスを離す
- **期待結果**: 
  - 開始日と終了日が同じ日数分移動する
  - 変更が保存される
  - 自動コメントが追加されない（頻繁な変更のため）

**TC-GANTT-006**: ガントチャートでの期間変更（左端ドラッグ）
- **優先度**: High
- **前提条件**: ログイン済み、編集可能なタスクが存在する、ガントチャート画面
- **手順**:
  1. タスクバーの左端をドラッグ
  2. マウスを離す
- **期待結果**: 
  - 開始日が変更される
  - 終了日は変更されない
  - 変更が保存される

**TC-GANTT-007**: ガントチャートでの期間変更（右端ドラッグ）
- **優先度**: High
- **前提条件**: ログイン済み、編集可能なタスクが存在する、ガントチャート画面
- **手順**:
  1. タスクバーの右端をドラッグ
  2. マウスを離す
- **期待結果**: 
  - 終了日が変更される
  - 開始日は変更されない
  - 変更が保存される

---

## 11. 統計機能

### 11.1 作業時間統計

**TC-STAT-001**: 作業時間統計の表示
- **優先度**: Medium
- **前提条件**: ログイン済み、作業セッションが記録されている
- **手順**:
  1. 統計画面を開く
- **期待結果**: 
  - 作業時間の統計が表示される
  - グラフが表示される

**TC-STAT-002**: 作業時間統計のグラフ（ダークモード）
- **優先度**: Low
- **前提条件**: ログイン済み、ダークモード、作業セッションが記録されている
- **手順**:
  1. 統計画面を開く
- **期待結果**: 
  - グラフの線が表示される
  - テーマに応じた色が適用される

---

## 12. テーマ設定

### 12.1 テーマ切り替え

**TC-THEME-001**: ライトモードへの切り替え
- **優先度**: Medium
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. テーマ設定で「ライト」を選択
  2. 設定を保存
- **期待結果**: 
  - ライトモードが適用される
  - 全ページでテーマが反映される

**TC-THEME-002**: ダークモードへの切り替え
- **優先度**: Medium
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. テーマ設定で「ダーク」を選択
  2. 設定を保存
- **期待結果**: 
  - ダークモードが適用される
  - 日付/時刻ピッカーのアイコンが白色になる

**TC-THEME-003**: システム設定に従う
- **優先度**: Low
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. テーマ設定で「システム設定に従う」を選択
  2. 設定を保存
- **期待結果**: 
  - システムの設定に従ってテーマが適用される

---

## 13. アーカイブ機能

### 13.1 ゴミ箱

**TC-ARCHIVE-001**: ゴミ箱の表示
- **優先度**: High
- **前提条件**: ログイン済み、削除されたタスク・プロジェクトが存在する
- **手順**:
  1. ゴミ箱画面を開く
- **期待結果**: 
  - 削除されたタスク・プロジェクトが表示される

**TC-ARCHIVE-002**: ゴミ箱からの復元（タスク）
- **優先度**: High
- **前提条件**: ログイン済み、削除されたタスクが存在する
- **手順**:
  1. ゴミ箱画面でタスクの「復元」ボタンをクリック
- **期待結果**: 
  - タスクが復元される
  - タスク一覧に表示される

**TC-ARCHIVE-003**: ゴミ箱からの復元（プロジェクト）
- **優先度**: High
- **前提条件**: ログイン済み、削除されたプロジェクトが存在する
- **手順**:
  1. ゴミ箱画面でプロジェクトの「復元」ボタンをクリック
- **期待結果**: 
  - プロジェクトが復元される
  - 配下のタスクも復元される

**TC-ARCHIVE-004**: ゴミ箱からの一括復元
- **優先度**: Medium
- **前提条件**: ログイン済み、複数の削除されたタスク・プロジェクトが存在する
- **手順**:
  1. ゴミ箱画面で「一括復元」ボタンをクリック
- **期待結果**: 
  - フィルターされたすべてのアイテムが復元される

**TC-ARCHIVE-005**: ゴミ箱からの完全削除
- **優先度**: Medium
- **前提条件**: ログイン済み、削除されたタスク・プロジェクトが存在する、権限あり
- **手順**:
  1. ゴミ箱画面で「完全削除」ボタンをクリック
  2. 確認ダイアログで「削除」を選択
- **期待結果**: 
  - アイテムが完全に削除される
  - Firestoreから削除される

---

## 14. タスクインポート

### 14.1 ファイルアップロード

**TC-IMPORT-001**: Excelファイルのアップロード
- **優先度**: Medium
- **前提条件**: ログイン済み、タスクインポート画面
- **手順**:
  1. Excelファイルを選択
  2. 「アップロード」ボタンをクリック
- **期待結果**: 
  - ファイルが読み込まれる
  - マッピング画面が表示される

**TC-IMPORT-002**: CSVファイルのアップロード
- **優先度**: Medium
- **前提条件**: ログイン済み、タスクインポート画面
- **手順**:
  1. CSVファイルを選択
  2. 「アップロード」ボタンをクリック
- **期待結果**: 
  - ファイルが読み込まれる

**TC-IMPORT-003**: ファイル形式エラー
- **優先度**: Medium
- **前提条件**: ログイン済み、タスクインポート画面
- **手順**:
  1. 無効なファイル形式を選択
- **期待結果**: 
  - エラーメッセージが表示される

### 14.2 カラムマッピング

**TC-IMPORT-004**: カラムマッピングの設定
- **優先度**: Medium
- **前提条件**: ログイン済み、ファイルがアップロード済み
- **手順**:
  1. 各Excelカラムに対応するフィールドを選択
  2. 「次へ」ボタンをクリック
- **期待結果**: 
  - マッピングが保存される
  - プレビュー画面が表示される

**TC-IMPORT-005**: チーム名による個人/チームタスクの割り当て
- **優先度**: Medium
- **前提条件**: ログイン済み、ファイルがアップロード済み、チーム名カラムが存在する
- **手順**:
  1. チーム名カラムをマッピング
  2. プレビュー画面で確認
- **期待結果**: 
  - チーム名が空、「-」、「ー」、「個人」の場合は個人タスクとして扱われる
  - チーム名が存在する場合はチームタスクとして扱われる

**TC-IMPORT-006**: 存在しないチーム名の処理
- **優先度**: Medium
- **前提条件**: ログイン済み、ファイルがアップロード済み、存在しないチーム名が含まれる
- **手順**:
  1. 存在しないチーム名の行をインポートしようとする
- **期待結果**: 
  - ユーザーに選択肢が提示される（チーム作成、個人タスクとして作成、修正、スキップ）

### 14.3 プレビュー・インポート

**TC-IMPORT-007**: プレビューの表示
- **優先度**: Medium
- **前提条件**: ログイン済み、マッピングが完了
- **手順**:
  1. プレビュー画面を確認
- **期待結果**: 
  - インポートされるタスクのプレビューが表示される
  - エラーがある場合は表示される

**TC-IMPORT-008**: タスクのインポート実行
- **優先度**: High
- **前提条件**: ログイン済み、プレビュー画面
- **手順**:
  1. 「インポート」ボタンをクリック
- **期待結果**: 
  - タスクが作成される
  - 結果画面が表示される

**TC-IMPORT-009**: インポートの戻るボタン
- **優先度**: Low
- **前提条件**: ログイン済み、インポート画面の各ステップ
- **手順**:
  1. 「戻る」ボタンをクリック
- **期待結果**: 
  - 前のステップに戻る（結果→プレビュー→マッピング→アップロード）

---

## 15. その他の機能

### 15.1 次やるタスク候補

**TC-NEXT-001**: 次やるタスク候補の表示
- **優先度**: Medium
- **前提条件**: ログイン済み、未完了タスクが存在する
- **手順**:
  1. ホーム画面を開く
- **期待結果**: 
  - 優先度と期限に基づいて次に取り組むべきタスクが提案される
  - モーダルで表示される（設定で有効な場合）

**TC-NEXT-002**: 次やるタスク候補の非表示設定
- **優先度**: Low
- **前提条件**: ログイン済み、設定画面
- **手順**:
  1. 「次やるタスクを表示する」のチェックを外す
  2. 設定を保存
- **期待結果**: 
  - 次やるタスク候補が表示されなくなる

### 15.2 アカウント設定

**TC-ACCOUNT-001**: アカウント情報の表示
- **優先度**: Medium
- **前提条件**: ログイン済み、アカウント画面
- **手順**:
  1. アカウント画面を開く
- **期待結果**: 
  - ユーザー情報が表示される

**TC-ACCOUNT-002**: プロフィール画像の設定
- **優先度**: Low
- **前提条件**: ログイン済み、アカウント画面
- **手順**:
  1. プロフィール画像をアップロード
- **期待結果**: 
  - プロフィール画像が更新される

---

## 16. UI/UX

### 16.1 ナビゲーション

**TC-UI-001**: サイドバーの表示・非表示
- **優先度**: Medium
- **前提条件**: ログイン済み
- **手順**:
  1. サイドバーの開閉ボタンをクリック
- **期待結果**: 
  - サイドバーが開閉する
  - 768px以下で自動的に閉じる

**TC-UI-002**: 戻るボタンの動作
- **優先度**: Medium
- **前提条件**: ログイン済み、複数のページを閲覧
- **手順**:
  1. 各ページの「戻る」ボタンをクリック
- **期待結果**: 
  - ブラウザの履歴に従って前のページに戻る
  - 履歴がない場合はホーム画面に遷移

**TC-UI-003**: レスポンシブデザイン（モバイル）
- **優先度**: Medium
- **前提条件**: ログイン済み、モバイルデバイスまたは768px以下の画面幅
- **手順**:
  1. 画面幅を768px以下に変更
- **期待結果**: 
  - サイドバーが自動的に閉じる
  - レイアウトが適切に調整される

### 16.2 ヘッダー統一

**TC-UI-004**: ヘッダーの統一性
- **優先度**: Low
- **前提条件**: ログイン済み、各ページ
- **手順**:
  1. 各ページのヘッダーを確認
- **期待結果**: 
  - ヘッダーの高さ、スタイルが統一されている
  - 戻るボタンとタイトルの位置が統一されている

---

## 17. エラーハンドリング

### 17.1 ネットワークエラー

**TC-ERROR-001**: ネットワークエラー時の動作
- **優先度**: High
- **前提条件**: ログイン済み、ネットワークが切断される
- **手順**:
  1. ネットワークを切断
  2. タスクの作成・編集を試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - ユーザーフレンドリーなメッセージが表示される

**TC-ERROR-002**: Firestoreエラー時の動作
- **優先度**: High
- **前提条件**: ログイン済み、Firestoreエラーが発生
- **手順**:
  1. 権限のない操作を試みる
- **期待結果**: 
  - エラーメッセージが表示される
  - 適切なエラーハンドリングが行われる

### 17.2 データ整合性

**TC-ERROR-003**: 削除されたタスクへのアクセス
- **優先度**: Medium
- **前提条件**: ログイン済み、削除されたタスクのIDが存在する
- **手順**:
  1. 削除されたタスクのURLに直接アクセス
- **期待結果**: 
  - エラーメッセージが表示される、または
  - ゴミ箱画面にリダイレクトされる

---

## 18. パフォーマンス

### 18.1 データ取得

**TC-PERF-001**: 大量タスクの表示
- **優先度**: Medium
- **前提条件**: ログイン済み、100件以上のタスクが存在する
- **手順**:
  1. タスク一覧画面を開く
- **期待結果**: 
  - タスクが適切に表示される
  - パフォーマンスが許容範囲内

**TC-PERF-002**: フィルター・ソートのパフォーマンス
- **優先度**: Medium
- **前提条件**: ログイン済み、大量のタスクが存在する
- **手順**:
  1. フィルターとソートを適用
- **期待結果**: 
  - フィルター・ソートが迅速に実行される

---

## テスト実行の優先順位

### Phase 1: 最重要機能（High優先度）
- 認証・ユーザー管理
- タスク作成・編集・削除
- プロジェクト作成・編集
- チーム管理
- 日付チェック機能
- 通知システム

### Phase 2: 重要機能（Medium優先度）
- リマインダー機能
- コメント機能
- 作業時間計測
- ガントチャート
- タスクインポート

### Phase 3: 補助機能（Low優先度）
- 統計機能
- テーマ設定
- UI/UXの細かい調整

